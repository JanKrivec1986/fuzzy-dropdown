/**
 * @license Fuse - https://github.com/krisk/Fuse/blob/master/LICENSE
 * @license fuzzyDropdown - https://github.com/zeusdeux/fuzzyDropdown/blob/master/LICENSE
 **/
(function($,Fuse){function makeList2Json(iterable){var locationArr=[];var $this;$.each(iterable,function(){$this=$(this);locationArr.push({value:$this.val(),text:$this.text().trim()})});return locationArr}$.fn.fuzzyDropdown=function(options){var _opts=$.extend({},options);var $this=$(this);var $currentSelected;var $mainContainer=$(_opts.mainContainer);var $currentValCont=$($mainContainer.children("div")[0]);var $currentValSpan=$currentValCont.children("span:first");var $arrowSpan=$($currentValCont.children("span")[1]);var $dropdownCont=$($mainContainer.children("div")[1]);var $searchInput=$dropdownCont.children("input:first");var $dropdownUL=$dropdownCont.children("ul:first");var $lis;var list=$this.children("option");var locations=makeList2Json(list);var noResultsId=+new Date+"-no-results-found";var html;var fuse=new Fuse(locations,{keys:["text"],id:"value",location:_opts.location||0,threshold:_opts.threshold||.61,distance:_opts.distance||110,maxPatternLength:_opts.maxPatternLength||64,caseSensitive:_opts.caseSensitive||false,includeScore:_opts.includeScore||false,shouldSort:_opts.shouldSort||true});if(!$this.children("option").length)return;console.debug("fuzzyDropdown: threshold is "+_opts.threshold);$this.hide();if($(_opts.mainContainer+":hidden").length){$mainContainer.show()}$currentSelected=$this.children("option[selected]");$currentSelected=$currentSelected.length?$currentSelected:$this.children("option:first");$currentValSpan.attr("data-val",$currentSelected.val());$currentValSpan.text($currentSelected.text());for(var i=0;i<list.length;i++){html='<li data-val="'+list[i].value+'">'+list[i].text+"</li>";$dropdownUL.append(html)}$dropdownUL.append('<li id="'+noResultsId+'" style="display:none;">No results found yet. Keep typing for more matches.</li>');$lis=$dropdownUL.children("li");$searchInput.keyup(function(evt){var $this=$(this);var val=$this.val();var results;if(val===""){$lis.css("display","list-item");$("#"+noResultsId).css("display","none")}else{results=fuse.search(val);if(results.length){$lis.css("display","none");$lis.each(function(){var $this=$(this);for(var i=0;i<results.length;i++){if($this.attr("data-val")===""+results[i]){$this.css("display","list-item")}}})}else{$lis.css("display","none");$("#"+noResultsId).css("display","list-item")}}});function clearSelectedClass(){$dropdownUL.children("."+_opts.selectedClass).removeClass(_opts.selectedClass)}$currentValCont.click(function(evt){evt.preventDefault();evt.stopPropagation();$arrowSpan.toggleClass(_opts.arrowUpClass);$dropdownCont.slideToggle(100);if($dropdownCont.is(":visible"))$searchInput.focus().select();clearSelectedClass()});$dropdownCont.on("click","li",function(evt){var $self=$(this);$currentValSpan.attr("data-val",$self.attr("data-val"));$currentValSpan.text($self.text());$this.children("option[value="+$self.attr("data-val")+"]").attr("selected","selected").change()});$("body").click(function(){if($dropdownCont.is(":visible")&&!$searchInput.is(":focus"))$currentValCont.click()});$searchInput.keydown(function(e){e.stopPropagation();clearSelectedClass();if($dropdownUL.children(":visible:first").get(0)===$("#"+noResultsId).get(0)){clearSelectedClass();return}if(e.keyCode===40){$dropdownUL.children(":visible:first").addClass(_opts.selectedClass);$searchInput.blur()}});$dropdownUL.on("keydown","li",function(e){var $this=$(this);var isFirst=$dropdownUL.children(":visible:first").get(0)===$this.get(0);var isLast=$dropdownUL.children(":visible:last").get(0)===$this.get(0);var $next=$this.next();var $prev=$this.prev();e.preventDefault();e.stopPropagation();if(isFirst&&e.keyCode===38){$this.removeClass(_opts.selectedClass);$searchInput.focus().select();return}if(isLast&&e.keyCode===40){return}if(e.keyCode===40){$this.removeClass(_opts.selectedClass);while(!$next.is(":visible")){$next=$next.next()}$next.addClass(_opts.selectedClass);return}if(e.keyCode===38){$this.removeClass(_opts.selectedClass);while(!$prev.is(":visible")){$prev=$prev.prev()}$prev.addClass(_opts.selectedClass);return}if(e.keyCode===13)$this.click()});$("body").on("keydown",function(e){var evt;if($dropdownCont.is(":visible")&&(e.keyCode===38||e.keyCode===40||e.keyCode===13)){e.preventDefault();e.stopPropagation();evt=$.Event("keydown");evt.keyCode=e.keyCode;$dropdownUL.children("."+_opts.selectedClass).trigger(evt)}})}})(window.jQuery,window.Fuse);
//# sourceMappingURL=fuzzyDropdown.min.map